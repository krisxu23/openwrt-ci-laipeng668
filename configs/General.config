# ==================================================
# 通用编译配置 (General Build Configuration)
# ==================================================
CONFIG_USE_APK=n                                          # 禁用APK安装包
CONFIG_DEVEL=y                                            # 启用开发者选项 (提供更详细的调试信息)
CONFIG_TARGET_OPTIONS=y                                   # 启用目标平台特定选项
CONFIG_TARGET_OPTIMIZATION="-O3 -pipe -march=armv8-a+crypto+crc -mcpu=cortex-a53+crypto+crc -mtune=cortex-a53" # 设置编译器优化: -O3 优化等级, 并针对 Cortex-A53 架构进行优化
CONFIG_CCACHE=y                                           # 启用 ccache 编译缓存, 加快后续编译速度
CONFIG_PACKAGE_default-settings=y                         # 包含默认的系统设置
CONFIG_PACKAGE_default-settings-chn=y                     # 包含针对中国区的默认设置 (如 NTP 服务器等)
CONFIG_TARGET_PER_DEVICE_ROOTFS=y                         # 为每个设备生成独立的根文件系统
CONFIG_LUCI_LANG_zh_Hant=y                                # 编译繁体中文 LuCI 语言包

# ==================================================
# 明确禁用的配置
# ==================================================
# CONFIG_FEED_nss_packages is not set                     # 不使用 nss-packages 这个 feed 源 (因为已手动选择)
# CONFIG_FEED_sqm_scripts_nss is not set                  # 不使用 sqm-scripts-nss 这个 feed 源
# CONFIG_TARGET_ROOTFS_INITRAMFS is not set               # 不编译 initramfs 格式的固件 (用于内存启动)

# ==================================================
# 内核模块 - USB 支持 (Kernel Modules - USB Support)
# ==================================================
CONFIG_PACKAGE_kmod-usb2=y                                # USB 2.0 支持
CONFIG_PACKAGE_kmod-usb3=y                                # USB 3.0 支持
CONFIG_PACKAGE_kmod-usb-audio=y                           # USB 声卡支持
CONFIG_PACKAGE_kmod-usb-core=y                            # USB 核心支持
CONFIG_PACKAGE_kmod-usb-dwc3=y                            # DesignWare USB3 控制器支持
CONFIG_PACKAGE_kmod-usb-net=y                             # USB 网络设备通用支持
CONFIG_PACKAGE_kmod-usb-net-cdc-eem=y                     # USB CDC EEM 协议网卡支持
CONFIG_PACKAGE_kmod-usb-net-cdc-ether=y                   # USB CDC ECM 协议网卡支持 (常见于安卓手机USB共享网络)
CONFIG_PACKAGE_kmod-usb-net-cdc-mbim=y                    # USB MBIM 协议网卡支持 (4G/5G模块)
CONFIG_PACKAGE_kmod-usb-net-cdc-ncm=y                     # USB CDC NCM 协议网卡支持 (新型4G/5G模块)
CONFIG_PACKAGE_kmod-usb-net-cdc-subset=y                  # USB CDC 子集驱动
CONFIG_PACKAGE_kmod-usb-net-huawei-cdc-ncm=y              # 华为 NCM 模式 USB 网卡支持
CONFIG_PACKAGE_kmod-usb-net-ipheth=y                      # iPhone USB 共享网络支持
CONFIG_PACKAGE_kmod-usb-net-qmi-wwan=y                    # QMI 协议蜂窝网卡支持 (高通4G/5G模块)
CONFIG_PACKAGE_kmod-usb-net-qmi-wwan-fibocom=y            # 广和通 (Fibocom) QMI 模块支持
CONFIG_PACKAGE_kmod-usb-net-qmi-wwan-quectel=y            # 移远 (Quectel) QMI 模块支持
CONFIG_PACKAGE_kmod-usb-net-rndis=y                       # RNDIS 协议网卡支持 (常见于Windows手机或一些USB网卡)
CONFIG_PACKAGE_kmod-usb-net-rtl8150=y                     # Realtek RTL8150 USB 网卡支持
CONFIG_PACKAGE_kmod-usb-net-rtl8152=y                     # Realtek RTL8152/RTL8153 USB 千兆网卡支持
CONFIG_PACKAGE_kmod-usb-ohci=y                            # OHCI USB 控制器支持 (USB 1.1)
CONFIG_PACKAGE_kmod-usb-storage=y                         # USB 存储设备支持 (U盘, 移动硬盘)
CONFIG_PACKAGE_kmod-usb-storage-extras=y                  # USB 存储设备额外支持 (如读卡器)
CONFIG_PACKAGE_kmod-usb-storage-uas=y                     # USB UAS 协议支持 (提升USB存储速度)
CONFIG_PACKAGE_kmod-usb-uhci=y                            # UHCI USB 控制器支持 (USB 1.1)
CONFIG_PACKAGE_kmod-usb-xhci=y                            # XHCI USB 控制器支持 (USB 3.0)
CONFIG_PACKAGE_block-mount=y
CONFIG_PACKAGE_usbutils=y

# ==================================================
# Docker - 核心内核模块依赖
# ==================================================
CONFIG_PACKAGE_kmod-br-netfilter=y                       # 启用网桥 netfilter，这是实现容器网络隔离和通信的关键
CONFIG_PACKAGE_kmod-ip6tables=y                          # 启用对 IPv6 防火墙规则的支持
CONFIG_PACKAGE_kmod-ipt-conntrack=y                      # 提供连接跟踪功能，用于管理网络状态
CONFIG_PACKAGE_kmod-ipt-extra=y                          # 提供额外的 iptables 功能模块
CONFIG_PACKAGE_kmod-ipt-nat=y                            # 提供网络地址转换 (NAT) 功能，允许容器访问外部网络
CONFIG_PACKAGE_kmod-ipt-nat6=y                           # 提供针对 IPv6 的 NAT 功能
CONFIG_PACKAGE_kmod-ipt-physdev=y                        # 允许基于物理设备进行防火墙规则匹配，对网桥环境下的容器网络很重要
CONFIG_PACKAGE_kmod-nf-ipt6=y                            # Netfilter 的 IPv6 核心支持
CONFIG_PACKAGE_kmod-nf-ipvs=y                            # 启用 IP 虚拟服务器 (IPVS)，可用于 Docker 的负载均衡
CONFIG_PACKAGE_kmod-nf-nat6=y                            # Netfilter 的 IPv6 NAT 核心支持
CONFIG_PACKAGE_kmod-dummy=y                              # 提供一个虚拟网络接口
CONFIG_PACKAGE_kmod-veth=y                               # 提供虚拟以太网设备对（Virtual Ethernet Pair），用于连接容器的网络命名空间和主机的网桥
CONFIG_PACKAGE_iptables-mod-extra=y                      # iptables 的额外模块集合
CONFIG_PACKAGE_ip6tables-mod-fullconenat=y               # 为 ip6tables 提供 Full Cone NAT 支持
CONFIG_PACKAGE_iptables-mod-fullconenat=y                # 为 iptables 提供 Full Cone NAT (全锥形NAT) 支持，可以改善某些P2P或游戏应用的联机效果
CONFIG_PACKAGE_libip4tc=y                                # iptables 命令所依赖的核心库
CONFIG_PACKAGE_libip6tc=y                                # ip6tables 命令所依赖的核心库
CONFIG_PACKAGE_luci-app-dockerman=y                      # 编译 luci-app-dockerman 应用
CONFIG_PACKAGE_luci-i18n-dockerman-zh-cn=y               # luci-app-dockerman 提供简体中文语言包
CONFIG_KERNEL_CGROUP_BLKIO=y                             # (required) 块I/O限流，避免高负载争用
CONFIG_KERNEL_CGROUP_CPUACCT=y                           # (required) CPU使用会计
CONFIG_KERNEL_CGROUP_MEMORY=y                            # (required) 内存限额/监控
CONFIG_KERNEL_CGROUP_PIDS=y                              # (required) 进程数限额
CONFIG_KERNEL_CGROUP_SCHED=y                             # (required) CPU调度优先级
CONFIG_KERNEL_NAMESPACES=y                               # (required) 命名空间全支持（menuconfig中全选子项：NET/PID/UTS/IPC/USER/MOUNT）
CONFIG_KERNEL_SECCOMP=y                                  # (required) seccomp沙箱基础
CONFIG_KERNEL_SECCOMP_FILTER=y                           # (recommended) 高级过滤，提升安全
CONFIG_PACKAGE_kmod-ebtables=y                           # (recommended) ebtables桥接过滤核心
CONFIG_PACKAGE_kmod-ebtables-ipv4=y                      # (recommended) IPv4桥接
CONFIG_PACKAGE_kmod-ebtables-ipv6=y                      # (recommended) IPv6桥接
CONFIG_PACKAGE_kmod-nf-conntrack-netlink=y               # (recommended) 连接跟踪Netlink（动态规则更新）
CONFIG_PACKAGE_kmod-ipt-ipset=y                          # (recommended) IPSet高效匹配（规则优化）
CONFIG_PACKAGE_kmod-nf-nathelper=y                       # (recommended) NAT助手模块
CONFIG_PACKAGE_kmod-nf-nathelper-extra=y                 # (recommended) 额外NAT助手（FTP等协议）
CONFIG_PACKAGE_kmod-nf-tproxy=y                          # (recommended，已部分) TPROXY透明代理
CONFIG_PACKAGE_kmod-macvlan=y                            # (recommended) MACVLAN模式（容器直连物理网）
CONFIG_PACKAGE_kmod-vxlan=y                              # (recommended) VXLAN隧道（多主机集群）
CONFIG_OVERLAY_FS=y                                      # (required) Overlay文件系统（内核内置，menuconfig: File systems > Overlay filesystem）
CONFIG_PACKAGE_kmod-fs-overlay=y                         # (required) Overlay内核模块
CONFIG_KERNEL_BLK_DEV_THROTTLING=y                       # (recommended) 块设备I/O节流
CONFIG_KERNEL_BLK_DEV_BSG=y                              # (recommended) 块设备SCSI泛型（高级I/O）
CONFIG_PACKAGE_cgroupfs-mount=y                          # (required) cgroupfs自动挂载（确保cgroups层次完整）
CONFIG_PACKAGE_containerd=y                              # (required) OCI运行时
CONFIG_PACKAGE_docker=y                                  # (required) Docker CLI
CONFIG_PACKAGE_dockerd=y                                 # (required) Docker守护进程
CONFIG_PACKAGE_runc=y                                    # (required) 低级运行时
CONFIG_PACKAGE_libseccomp=y                              # (required) seccomp库
CONFIG_PACKAGE_iptables=y                                # (required) iptables工具（若未全局启用）
CONFIG_PACKAGE_ip-full=y                                 # (required) IP路由工具
CONFIG_PACKAGE_libxtables=y                              # (required) x_tables库
CONFIG_PACKAGE_kmod-ipt-core=y                           # (required) iptables核心模块

# --- 为 Docker 和容器化提供核心支持 (Cgroups) ---
CONFIG_KERNEL_CGROUP_DEVICE=y                           # 启用 Cgroup 设备控制器
CONFIG_KERNEL_CGROUP_FREEZER=y                          # 启用 Cgroup 冻结器, 用于暂停/恢复任务组
CONFIG_KERNEL_CGROUP_HUGETLB=y                          # 启用 Cgroup 大内存页控制器
CONFIG_KERNEL_CGROUP_NET_PRIO=y                         # 启用 Cgroup 网络优先级控制器
CONFIG_KERNEL_CGROUP_PERF=y                             # 启用 Cgroup 性能事件监控
CONFIG_KERNEL_MEMCG_SWAP_ENABLED=y                      # 允许内存控制组使用交换空间 (Swap)
CONFIG_KERNEL_NET_CLS_CGROUP=y                          # 允许流量分类器与 Cgroup 交互
CONFIG_PACKAGE_kmod-tun=y
CONFIG_PACKAGE_kmod-wireguard=y
CONFIG_PACKAGE_docker-compose=y

# --- 其他内核优化 ---
CONFIG_KERNEL_CFQ_GROUP_IOSCHED=y                       # 启用 CFQ I/O 调度器的组调度功能

# ==================================================
# 软件包 - 系统工具 (Packages - System Utilities)
# ==================================================
CONFIG_PACKAGE_tmux=y                                     # 终端复用器 tmux
CONFIG_PACKAGE_dmesg=y                                    # 查看内核日志工具 dmesg
CONFIG_PACKAGE_htop=y                                     # 交互式进程查看器 htop
CONFIG_PACKAGE_btop=y                                     # 更现代化的系统监视器 btop
CONFIG_PACKAGE_fdisk=y                                    # 磁盘分区工具 fdisk (MBR)
CONFIG_PACKAGE_cfdisk=y                                   # 交互式磁盘分区工具 cfdisk
CONFIG_PACKAGE_sgdisk=y                                   # 磁盘分区工具 sgdisk (GPT)
CONFIG_PACKAGE_tune2fs=y                                  # ext2/3/4 文件系统调整工具
CONFIG_PACKAGE_ariang=y                                   # Aria2 的 Web 前端界面
CONFIG_PACKAGE_fstrim=y                                   # 对 SSD 进行 TRIM 操作的工具
CONFIG_PACKAGE_nano-full=y                                # 功能完整的 nano 文本编辑器
CONFIG_PACKAGE_autocore=y                                 # CPU 核心及频率自动优化工具
CONFIG_PACKAGE_coremark=y                                 # CoreMark CPU 性能跑分工具
CONFIG_PACKAGE_zram-swap=y                                # 使用 ZRAM (内存压缩) 作为虚拟内存
CONFIG_PACKAGE_kmod-lib-lz4=y                             # LZ4 压缩算法内核库 (zram-swap 依赖)
CONFIG_PACKAGE_hdparm=y                                   # 硬盘参数读写工具
CONFIG_PACKAGE_smartmontools-drivedb=y                    # 硬盘 S.M.A.R.T. 健康状态检测工具
CONFIG_PACKAGE_zoneinfo-asia=y                            # 亚洲时区信息
CONFIG_PACKAGE_acme-acmesh-dnsapi=y                       # acme.sh 证书申请工具的 DNS API 脚本
CONFIG_PACKAGE_openssh-sftp-server=y                      # OpenSSH 的 SFTP 服务端
CONFIG_PACKAGE_ddns-scripts-cloudflare=y                  # Cloudflare 的 DDNS 更新脚本
CONFIG_PACKAGE_kmod-nft-socket=y                          # 编译 nftables 套接字内核模块
CONFIG_PACKAGE_kmod-sched-cake=y
CONFIG_PACKAGE_kmod-ifb=y

# --- 内存管理与性能优化 ---
CONFIG_KERNEL_ARM_PMU=y                                 # 启用 ARM 性能监控单元 (PMU), 用于性能分析
CONFIG_KERNEL_PERF_EVENTS=y                             # 启用内核性能事件框架, 用于高级系统诊断
CONFIG_KERNEL_HUGETLBFS=y                               # 启用 HugeTLB 文件系统支持 (大内存页)
CONFIG_KERNEL_HUGETLB_PAGE=y                            # 启用大内存页支持, 提升内存密集型应用性能
CONFIG_KERNEL_TRANSPARENT_HUGEPAGE=y                    # 启用透明大页支持
CONFIG_KERNEL_TRANSPARENT_HUGEPAGE_ALWAYS=y             # 总是尝试使用透明大页

# --- 文件系统支持 ---
CONFIG_PACKAGE_kmod-fs-ext4=y                             # EXT4 文件系统内核支持
CONFIG_PACKAGE_e2fsprogs=y                                # EXT4 命令行工具 (格式化、检查)
CONFIG_PACKAGE_kmod-fs-ntfs3=y                            # 高性能 NTFS 文件系统内核支持
CONFIG_PACKAGE_ntfs3-utils=y                              # NTFS3 命令行工具
CONFIG_PACKAGE_kmod-fs-exfat=y                            # exFAT 文件系统内核支持
CONFIG_PACKAGE_exfat-utils=y                              # exFAT 命令行工具
CONFIG_PACKAGE_kmod-fs-vfat=y                             # FAT32 文件系统内核支持

# --- 网络诊断工具 ---
CONFIG_PACKAGE_tcpdump=y                                  # 网络抓包工具
CONFIG_PACKAGE_iperf3=y                                   # 网络带宽测试工具
CONFIG_PACKAGE_curl=y                                     # 强大的网络请求工具
CONFIG_PACKAGE_bind-tools=y                               # 高级 DNS 查询工具 (dig, nslookup)

# --- 解压缩工具 ---
CONFIG_PACKAGE_unzip=y                                    # .zip 文件解压工具

# --- 系统历史性能监控 ---
CONFIG_PACKAGE_luci-app-statistics=y                      # LuCI 统计插件 (用于图形化显示CPU、内存、网络流量等历史数据)
CONFIG_PACKAGE_collectd=y                                 # 数据收集后台服务 (为 luci-app-statistics 提供数据源)
CONFIG_PACKAGE_collectd-mod-cpu=y                         # collectd 的 CPU 状态统计模块
CONFIG_PACKAGE_collectd-mod-memory=y                      # collectd 的内存使用统计模块
CONFIG_PACKAGE_collectd-mod-interface=y                   # collectd 的网络接口流量统计模块
CONFIG_PACKAGE_collectd-mod-load=y                        # collectd 的系统平均负载统计模块
CONFIG_PACKAGE_collectd-mod-thermal=y                     # collectd 的温度监控模块 (需要硬件支持)
CONFIG_PACKAGE_lm-sensors=y                               # 硬件健康状况监控工具 (可在命令行使用 'sensors' 命令查看温度等)

# ==================================================
# DNS & DHCP 服务器 - 增强版 (dnsmasq-full)
# ==================================================
# 禁用默认的基础版 dnsmasq (通常会自动处理，显式写出更清晰)
# CONFIG_PACKAGE_dnsmasq is not set

# 启用功能完整的 dnsmasq-full
CONFIG_PACKAGE_dnsmasq-full=y

# 为 dnsmasq-full 开启 ipset/nftset 支持 (强烈推荐，代理分流依赖此项)
CONFIG_DNSMASQ_WITH_IPSET=y

# 为 dnsmasq-full 开启 DNSSEC 验证支持 (推荐，增强安全性)
CONFIG_DNSMASQ_WITH_DNSSEC=y

# ==================================================
# LuCI 应用程序 (LuCI Applications)
# ==================================================
CONFIG_PACKAGE_luci-theme-argon=y
CONFIG_PACKAGE_luci-app-argon-config=y                    # Argon 主题的配置插件
CONFIG_PACKAGE_luci-app-cpufreq=y                         # CPU 频率调节插件
CONFIG_PACKAGE_luci-app-ramfree=y                         # 手动释放内存插件
CONFIG_PACKAGE_luci-app-ddns=y                            # 动态域名解析 (DDNS) 插件
CONFIG_PACKAGE_luci-app-ttyd=y                            # 网页版终端 (ttyd) 插件
CONFIG_PACKAGE_luci-app-autoreboot=y                      # 自动重启计划插件
CONFIG_PACKAGE_luci-app-diskman=y                         # 磁盘管理插件 (挂载、格式化)
CONFIG_PACKAGE_luci-app-homeproxy=y                       # HomeProxy 代理插件
CONFIG_PACKAGE_luci-app-momo=y                            # momo 代理插件
CONFIG_PACKAGE_luci-app-nikki=y                           # nikki 代理插件
CONFIG_PACKAGE_luci-app-sqm=y                             # 流量整形 (SQM) 插件
CONFIG_PACKAGE_luci-app-mosdns=y                          # dns 插件
CONFIG_PACKAGE_luci-app-firewall=y                        # 编译 LuCI 的防火墙图形化配置界面
# ==================================================


# LuCI 相关
CONFIG_PACKAGE_luci-app-cpulimit=y
CONFIG_PACKAGE_cpulimit=y
CONFIG_PACKAGE_luci-app-partexp=y

# 开发工具链
CONFIG_PACKAGE_gcc=y
CONFIG_PACKAGE_gdb=y
CONFIG_PACKAGE_binutils=y
CONFIG_PACKAGE_make=y
CONFIG_PACKAGE_autoconf=y
CONFIG_PACKAGE_automake=y
CONFIG_PACKAGE_flex=y
CONFIG_PACKAGE_bison=y

# 脚本语言环境
CONFIG_PACKAGE_bash=y
CONFIG_PACKAGE_perl=y
CONFIG_PACKAGE_micropython=y

# 压缩相关工具
CONFIG_PACKAGE_p7zip-full=y
CONFIG_PACKAGE_unrar=y
CONFIG_PACKAGE_zip=y
CONFIG_PACKAGE_xz-utils=y
CONFIG_PACKAGE_zstd=y
CONFIG_PACKAGE_bzip2=y

# 高级文件系统
CONFIG_PACKAGE_kmod-fs-btrfs=y
CONFIG_PACKAGE_kmod-fs-xfs=y
CONFIG_PACKAGE_kmod-fuse=y

# 磁盘工具
CONFIG_PACKAGE_parted=y
CONFIG_PACKAGE_gdisk=y
